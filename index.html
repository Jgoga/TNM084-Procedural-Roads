<html>
	<head>
		<title>Procedural roads</title>
		<script type="text/javascript" src="assets/glMatrix-0.9.5.min.js"></script>
    	<script type="text/javascript" src="assets/webgl-utils.js"></script>
    	<script type="text/javascript" src="assets/PriorityQueue.js"></script>
    	<script type="text/javascript" src="assets/perlin.js"></script>
    	<script src="assets/three.min.js"></script>
    	<script type="text/javascript" src="assets/OrbitControls.js"></script>
    	<script type="text/javascript" src="utils.js"></script>
    	<script type="text/javascript" src="localConstraints.js"></script>
    	<script type="text/javascript" src="globalGoals.js"></script>
    	<script type="text/javascript" src="roadGeneration.js"></script>
    	<script type="text/javascript" src="maps.js"></script>
    	<!-- // <script type="text/javascript" src="setup.js"></script> -->
		<style>
			body { margin: 0; }
			canvas { width: 100%; height: 800%}
		</style>
	</head>
	<body>
		<script>
		var camera, controls, scene, renderer;
		var width, height;
		var whie, red, green, blue;
		var terrainMap, waterMap, populationMap;
		var colorTex, dispTex;

		var queue, intersections ,geometry, pointMaterial;
		var dataW, dataT, dataP;

		var intervalId;

		var render = function(){
			controls.update();
			requestAnimationFrame( render );
			renderer.render(scene, camera);

			// geometry.vertices.push(new THREE.Vector3( 20*Math.random(), 20*Math.random(), 0));
			// geometry.verticesNeedUpdate = true;

		}

		function onWindowResize() {
			camera.aspect = window.innerWidth / window.innerHeight;
			camera.updateProjectionMatrix(); 
			renderer.setSize( window.innerWidth, window.innerHeight );
		}

		function init(){
			width = 1200;//window.innerWidth;
			height = 800;//window.innerHeight;

			roadColor 		= new THREE.LineBasicMaterial( { color: 0xffffff, linewidth: 1 } );
			highwayColor 	= new THREE.LineBasicMaterial( { color: 0xffffff, linewidth: 3 } );
			red 	= new THREE.MeshBasicMaterial( { color: 0xff0000 } );
			green 	= new THREE.MeshBasicMaterial( { color: 0x00ff00 } );
			blue 	= new THREE.MeshBasicMaterial( { color: 0x0000ff } );
			pointMaterialRed 	= new THREE.PointsMaterial( { color: 0xff0000, size: 4, sizeAttenuation: false } );
			pointMaterialGreen 	= new THREE.PointsMaterial( { color: 0x00ff00, size: 4, sizeAttenuation: false } );
			pointMaterialBlue 	= new THREE.PointsMaterial( { color: 0x0000ff, size: 4, sizeAttenuation: false } );

			noise.seed(Math.random());

			scene = new THREE.Scene();
			camera = new THREE.PerspectiveCamera(75, width/height, 0.1, 10000);
			camera.position.z = 800;
			renderer = new THREE.WebGLRenderer();
			renderer.setSize(width, height);
			controls = new THREE.OrbitControls( camera, renderer.domElement );
			document.body.appendChild(renderer.domElement);

			queue = new PriorityQueue(function(r1, r2){
				return r2.t - r1.t;
			})

			createMaps();
			firstSegment();

			window.addEventListener( 'resize', onWindowResize, false );
			intervalId = setInterval(createRoads, 0);
			render();
		}

		init();
		</script>
	</body>
</html>